<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login</title>

  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
  <link rel="stylesheet" href="login.css">
</head>
<body>

  <div class="container">

    <!-- Curved Background Shapes -->
    <div class="curved-shape"></div>
    <div class="curved-shape2"></div>

    <!-- LOGIN FORM -->
    <div class="form-box login">
      <h2 class="animation" style="--li:1">Login</h2>

      <form id="login">
        <div class="input-box animation" style="--li:2">
          <input type="text" required>
          <label>Username</label>
          <i class='bx bxs-user i'></i>
        </div>

        <div class="input-box animation" style="--li:3">
          <input type="password" required>
          <label>Password</label>
          <i class='bx bxs-lock-alt i'></i>
        </div>

        <div class="remember-forgot animation" style="--li:4">
          <label>
            <input type="checkbox" name="keepSignedIn"/>
            <span class="custom-checkbox"></span>
            Keep Me Signed In
          </label>
        </div>

        <button class="btn animation" type="submit" style="--li:5">Login</button>

        <div class="regi-link animation" style="--li:6">
          <p>Don't have an account? <a href="#" class="SignUpLink">SignUp</a></p>
        </div>
      </form>
    </div>

    <!-- LOGIN SIDE TEXT -->
    <div class="info-content login">
      <h2 class="animation" style="--li:1">WELCOME BACK</h2>
      <p class="animation" style="--li:2">
        Your Support Matters More Than Ever. Together,We're Weaving A Nationwide Safety Net For Palestinian Childrens.<br><br>
        "Every Login, Every Donation, Every Action Counts".<br><br>
        #SolidarityIsAction
      </p>
    </div>

    <!-- REGISTER FORM -->
    <div class="form-box Register">
      <h2 class="animation" style="--li:1">Register</h2>

      <form>
        <div class="input-box animation" style="--li:2">
          <input type="text" required>
          <label>Username</label>
          <i class='bx bxs-user i'></i>
        </div>

        <div class="input-box animation" style="--li:3">
          <input type="password" required>
          <label>Password</label>
          <i class='bx bxs-lock-alt i'></i>
        </div>

        <button class="btn animation" style="--li:4" type="submit">Register</button>

        <div class="regi-link animation" style="--li:5">
          <p>Already have an account? <a href="#" class="SignInLink">Login</a></p>
        </div>
      </form>
    </div>

    <!-- REGISTER SIDE TEXT -->
    <div class="info-content Register">
      <h2 class="animation" style="--li:1">WELCOME!</h2>
      <p class="animation" style="--li:2">
        Create Your Free Account To Provide Direct Humanitarian Aid To Palestinian Children In Crisis.<br><br>
        Together, We're Building A Nationwide Network Of Support One Donation, One Action, One Heart At A Time.
      </p>
    </div>

  </div>

  <script src="login.js"></script>

  <!-- ================= FIREBASE FIX ONLY ================= -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-analytics.js";
    import {
      getAuth,
      signInWithEmailAndPassword,
      createUserWithEmailAndPassword,
      setPersistence,
      browserLocalPersistence,
      browserSessionPersistence
    } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCi_Y9gqqmFWn7eSXlim3-8aog0sPfAUCw",
      authDomain: "change-life-9fff5.firebaseapp.com",
      projectId: "change-life-9fff5",
      storageBucket: "change-life-9fff5.firebasestorage.app",
      messagingSenderId: "748715021048",
      appId: "1:748715021048:web:904a110db8e431ff3ea10d",
      measurementId: "G-3BP5JBQ7LP"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const auth = getAuth(app);

    /* ================= LOGIN ================= */
    const loginForm = document.getElementById("login");

    loginForm.addEventListener("submit", (e) => {
      e.preventDefault();

      const inputs = loginForm.querySelectorAll("input");
      const email = inputs[0].value;
      const password = inputs[1].value;
      const keepSignedIn = inputs[2].checked;

      setPersistence(
        auth,
        keepSignedIn ? browserLocalPersistence : browserSessionPersistence
      )
      .then(() => {
        return signInWithEmailAndPassword(auth, email, password);
      })
      .then(() => {
        alert("Login Successful!");
        window.location.href = "index.html";
      })
      .catch((error) => {
        alert(error.message);
      });
    });

    /* ================= REGISTER ================= */
    const registerForm = document.querySelector(".form-box.Register form");

    registerForm.addEventListener("submit", (e) => {
      e.preventDefault();

      const inputs = registerForm.querySelectorAll("input");
      const email = inputs[0].value;
      const password = inputs[1].value;

      createUserWithEmailAndPassword(auth, email, password)
        .then(() => {
          alert("Account Created Successfully!");
          document.querySelector(".SignInLink").click();
        })
        .catch((error) => {
          alert(error.message);
        });
    });
  </script>

</body>
</html>
